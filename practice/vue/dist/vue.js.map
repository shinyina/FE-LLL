{"version":3,"file":"vue.js","sources":["../src/compiler/parse.js","../src/compiler/index.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function parse(templateString) {\r\n    //Pointer\r\n    let index = 0\r\n    //Remaining string\r\n    let restString = \"\"\r\n    //Start tag\r\n    let startRegExp = /^<([a-z]+[1-6]?)(\\s[^<]+)?>/\r\n    //The end tag\r\n    let endRegExp = /^<\\/([a-z]+[1-6]?)>/\r\n    //Define two stacks one to store labels and one to store content\r\n    let stackTag = []\r\n    let stackLetter = [{ children: [] }]\r\n    //Grab the text before the end tag\r\n    let wordRegExp = /^([^<]+)<\\/[a-z]+[1-6]?>/\r\n    while (index < templateString.length - 1) {\r\n        restString = templateString.substring(index)\r\n        if (startRegExp.test(restString)) {\r\n            let tag = restString.match(startRegExp)[1]\r\n            let attrsString = restString.match(startRegExp)[2]\r\n            //Push the tag and the object onto the stack, respectively\r\n            stackTag.push(tag)\r\n            stackLetter.push({\r\n                'tag': tag, 'children': [], \"attrs\":\r\n                    parseAttrsString(attrsString)\r\n            })\r\n            const attrsStringLength = attrsString !== undefined ? attrsString.length : 0\r\n            index += tag.length + 2 + attrsStringLength\r\n        } else if (endRegExp.test(restString)) {\r\n            let tag = restString.match(endRegExp)[1]\r\n            let pop_tag = stackTag.pop()\r\n            let pop_letter = stackLetter.pop()\r\n            if (tag === pop_tag) {\r\n                if (stackLetter.length > 0) {\r\n                    stackLetter[stackLetter.length - 1].children.push(pop_letter)\r\n                }\r\n            } else {\r\n                throw new Error(`${pop_tag} tag is not closed`)\r\n            }\r\n            index += tag.length + 3\r\n        } else if (wordRegExp.test(restString)) {\r\n            let word = restString.match(wordRegExp)[1]\r\n            if (!/^\\s+$/.test(word)) {\r\n                //Text is detected on top of stack\r\n                stackLetter[stackLetter.length - 1].children.push({\r\n                    \"text\": word, 'type':\r\n                        3\r\n                })\r\n            }\r\n            index += word.length\r\n        } else {\r\n            index++\r\n        }\r\n    }\r\n    return stackLetter[0].children[0]\r\n}\r\n\r\nfunction parseAttrsString(attrsString) {\r\n    if (attrsString === undefined) return []\r\n    //Whether the current is in quotation marks\r\n    let isYinHao = false\r\n    //breakpoint\r\n    let point = 0\r\n    //result array\r\n    let result = []\r\n    for (let i = 0; i < attrsString.length; i++) {\r\n        let char = attrsString[i]\r\n        if (char === '\"') {\r\n            isYinHao = !isYinHao\r\n        } else if (char === \" \" && !isYinHao) {\r\n            if (!/^\\s*?$/.test(attrsString.substring(point, i))) {\r\n                result.push(attrsString.substring(point, i).trim())\r\n                point = i\r\n            }\r\n        }\r\n    }\r\n    result.push(attrsString.substring(point))\r\n    result = result.map(item => {\r\n        const o = item.match(/^(.+)=(.+)$/)\r\n        return {\r\n            name: o[1],\r\n            value: o[2].substring(1, o[2].length - 1)\r\n        }\r\n    })\r\n    return result\r\n}","import { parse } from \"./parse\";\r\n\r\nexport function compileToFunction(template) {\r\n    const ast=parse(template)\r\n    console.log(ast);\r\n}\r\n","class Observer {\r\n    constructor(data) {\r\n        this.walk(data)\r\n    }\r\n    walk(data) {\r\n        Object.keys(data).forEach(key => defineRactive(data, key, data[key]))\r\n    }\r\n}\r\n\r\nfunction defineRactive(data, key, value) {\r\n    observe(value)\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n    if (typeof data !== 'object' || data === null) {\r\n        return\r\n    }\r\n    return new Observer(data);\r\n}\r\n","import { observe } from \"./observe/index\";\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction propxy(vm, target,key) {\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[target][key]\r\n        },\r\n        set(newValue){\r\n            vm[target][key] = newValue\r\n        }\r\n    })\r\n}\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    data = typeof data === 'function' ? data.call(vm) : data\r\n\r\n    vm._data = data\r\n    observe(data)\r\n\r\n    for (let key in data) {\r\n        propxy(vm, '_data', key)\r\n    }\r\n}","import { compileToFunction } from \"./compiler/index.js\";\r\nimport { initState } from \"./state\";\r\n\r\nexport default function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        this.$options = options\r\n\r\n        const vm = this;\r\n\r\n        initState(vm)\r\n\r\n        if (options.el) {\r\n            vm.$mount(options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this\r\n        let element = document.querySelector(el)\r\n        let opts = vm.$options\r\n        let template\r\n        if (!opts.template && el) {\r\n            template = element.outerHTML\r\n        }\r\n        else {\r\n            template = opts.template\r\n        }\r\n        if (template) {\r\n            const render = compileToFunction(template)\r\n            opts.render = render\r\n        }\r\n    }\r\n}\r\n","import initMixin from \"./init\"\r\n\r\nfunction Vue(options){\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["parse","templateString","index","restString","startRegExp","endRegExp","stackTag","stackLetter","children","wordRegExp","length","substring","test","tag","match","attrsString","push","parseAttrsString","attrsStringLength","undefined","pop_tag","pop","pop_letter","Error","word","isYinHao","point","result","i","char","trim","map","item","o","name","value","compileToFunction","template","ast","console","log","Observer","data","walk","Object","keys","forEach","key","defineRactive","observe","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","propxy","target","call","_data","initMixin","Vue","prototype","_init","options","el","$mount","element","document","querySelector","outerHTML","render"],"mappings":"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"}